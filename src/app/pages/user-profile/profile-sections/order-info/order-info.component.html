<!-- FILTERS -->
<div class="w-full h-fit mb-4 bg-white/60 rounded-lg flex flex-col ">
  <div class="flex w-full flex-cols items-center justify-between">
    <div class="mb-4 lg:mb-0 p-8 justify-start">
      <h2 class="text-xl font-bold">{{ 'PRODUCT_INVENTORY._search_criteria' | translate }}</h2>
    </div>
  </div>
  <div class="flex w-full flex-col items-center lg:flex-row justify-between">
    <div class="p-8 w-full">
      <div class="flex flex-row mb-1"> <fa-icon [icon]="faSwatchbook"
          class="fa-base text-primary-100 align-middle mr-2"></fa-icon>
        <h2 class="text-base font-bold">{{ 'OFFERINGS._filter_state' | translate }}</h2>
      </div> <button id="dropdownStateButton" data-dropdown-toggle="dropdown"
        class="text-black w-full justify-between bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-primary-100 font-medium rounded-lg text-sm p-2.5 text-center inline-flex items-center "
        type="button"> {{ 'OFFERINGS._filter_state' | translate }} <svg class="w-4 h-4 ml-2" aria-hidden="true"
          fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg> </button>
      <div id="dropdown" class="z-20 hidden w-fit md:w-1/5 p-3 bg-white rounded-lg ">
        <h6 class="mb-3 text-sm font-medium text-gray-900"> {{ 'OFFERINGS._status' | translate }} </h6>
        <ul class="space-y-2 text-sm" aria-labelledby="dropdownStateButton">
          <li class="flex items-center"> <input id="acknowledged" type="checkbox" value=""
              (change)="onStateFilterChange('acknowledged')"
              class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 focus:ring-2" />
            <label for="acknowledged" class="ml-2 text-sm font-medium text-gray-900"> {{ 'PROFILE._acknowledged' |
              translate }} </label>
          </li>
          <li class="flex items-center"> <input id="inProgress" type="checkbox" value=""
              (change)="onStateFilterChange('inProgress')"
              class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 focus:ring-2" />
            <label for="inProgress" class="ml-2 text-sm font-medium text-gray-900"> {{ 'PROFILE._in_progress' |
              translate }} </label>
          </li>
          <li class="flex items-center"> <input id="completed" type="checkbox" value=""
              (change)="onStateFilterChange('completed')"
              class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 focus:ring-2" />
            <label for="completed" class="ml-2 text-sm font-medium text-gray-900"> {{ 'PROFILE._completed' | translate
              }} </label>
          </li>
          <li class="flex items-center"> <input id="failed" type="checkbox" value=""
              (change)="onStateFilterChange('failed')"
              class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 focus:ring-2" />
            <label for="failed" class="ml-2 text-sm font-medium text-gray-900"> {{ 'PROFILE._failed' | translate }}
            </label>
          </li>
          <li class="flex items-center"> <input id="pending" type="checkbox" value=""
              (change)="onStateFilterChange('pending')"
              class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 focus:ring-2" />
            <label for="pending" class="ml-2 text-sm font-medium text-gray-900"> {{ 'PROFILE._pending' | translate }}
            </label>
          </li>
          <li class="flex items-center"> <input id="cancelled" type="checkbox" value=""
              (change)="onStateFilterChange('cancelled')"
              class="w-4 h-4 bg-gray-100 border-gray-300 rounded text-primary-600 focus:ring-primary-500 focus:ring-2" />
            <label for="cancelled" class="ml-2 text-sm font-medium text-gray-900"> {{ 'PROFILE._cancelled' | translate
              }} </label>
          </li>
        </ul>
      </div>
    </div> @if(isSeller){ <div class="p-8 w-full">
      <div class="flex flex-row mb-1"> <fa-icon [icon]="faIdCard"
          class="fa-base text-primary-100 align-middle mr-2"></fa-icon>
        <h2 class="text-base font-bold">{{ 'OFFERINGS._filter_role' | translate }}</h2>
      </div> <select id="roles" (change)="onRoleChange($event)"
        class="text-black border-0 w-full justify-between bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-primary-100 font-medium rounded-lg text-sm p-2.5 text-center inline-flex items-center ">
        <option class="text-left" value="Customer">{{ 'OFFERINGS._customer' | translate }}</option>
        <option class="text-left" value="Seller">{{ 'OFFERINGS._seller' | translate }}</option>
      </select>
    </div> }
  </div>
</div> <!-- END FILTERS --> @if (loading && !loading_more) { <div role="status"
  class="w-3/4 md:w-4/5 h-full flex justify-center align-middle"> <svg aria-hidden="true"
    class="w-12 h-12 text-gray-200 animate-spin fill-purple-600" viewBox="0 0 100 101" fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <path
      d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
      fill="currentColor" />
    <path
      d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
      fill="currentFill" />
  </svg> <span class="sr-only">Loading...</span> </div>
} @else { <div class="bg-white p-8 rounded-lg">
  <!-- <h2 class="md:text-3xl lg:text-4xl font-bold text-primary-100 ml-4 m-4">{{ 'PROFILE._order_list' | translate }}</h2> <hr class="h-px mr-4 ml-4 bg-primary-100 border-0">-->
  <div class="m-4 relative overflow-x-auto sm:rounded-lg">
    <table class="w-full text-sm text-left rtl:text-right text-primary-100">
      <thead class="text-primary-100 bg-green">
        <tr>
          <th scope="col" class="hidden md:table-cell px-6 py-3 text-center align-middle"> {{
            'PRODUCT_INVENTORY._order_id' | translate }} </th>
          <th scope="col" class="px-6 py-3 text-center align-middle"> {{ 'PRODUCT_INVENTORY._status' | translate }}
          </th>
          <th scope="col" class="hidden md:table-cell px-6 py-3 text-center align-middle"> {{
            'PRODUCT_INVENTORY._priority' | translate }} </th>
          <th scope="col" class="hidden md:table-cell px-6 py-3 text-center align-middle"> {{ 'PRODUCT_INVENTORY._bill'
            | translate }} </th>
          <th scope="col" class="px-6 py-3 text-center align-middle"> {{ 'PROFILE._date' | translate }} </th>
          <th scope="col" class="text-center align-middle"> {{ 'PROFILE._actions' | translate }} </th>
        </tr>
      </thead>
      <tbody> @for (order of orders; track order.id; let idx = $index) { <tr
          class="border-b bg-gray-100 hover:bg-gray-200">
          <td class="hidden md:table-cell px-6 py-4 text-center align-middle"> {{order.id}} </td>
          <td class="px-6 py-4 text-center align-middle"> @if(order.state == 'inProgress'){ <span
              class="bg-primary-50/30 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{order.state}}</span>
            } @else if(order.state == 'completed') { <span
              class="bg-green text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{order.state}}</span>
            } @else if(order.state == 'failed') { <span
              class="bg-red-500 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{order.state}}</span>
            } @else if(order.state == 'pending') { <span
              class="bg-yellow-500 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{order.state}}</span>
            }@else if(order.state == 'acknowledged'){ <span
              class="bg-primary-50/30 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{order.state}}</span>
            }@else if(order.state == 'cancelled') { <span
              class="bg-red-500 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{order.state}}</span>
            } </td>
          <td class="hidden md:table-cell px-6 py-4 text-center align-middle"> {{order.priority}} </td>
          <td class="hidden md:table-cell px-6 py-4 text-center align-middle"> {{order.billingAccount.name}} </td>
          <td class="px-6 py-4 text-center align-middle"> {{order?.orderDate | date:'EEEE, dd/MM/yy, HH:mm'}} </td>
          <td class="px-6 py-4 text-center align-middle"> <button
              (click)="toggleShowDetails(order);$event.stopPropagation();" type="button"
              class="text-white bg-primary-100 hover:bg-purple-800 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-full text-sm p-2.5 text-center inline-flex items-center me-2">
              <svg class="w-[18px] h-[18px] text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
                fill="none" viewBox="0 0 20 14">
                <g stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
                  <path d="M10 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                  <path d="M10 13c4.97 0 9-2.686 9-6s-4.03-6-9-6-9 2.686-9 6 4.03 6 9 6Z" />
                </g>
              </svg> </button> </td>
        </tr> } </tbody>
    </table> @if(orders.length == 0){ <div class="text-center items-center w-full col-span-2"> <span
        class="text-primary-100 text-sm text-center w-full font-medium">{{ 'PROFILE._no_orders' | translate }}</span>
    </div> }
  </div> @if (!loading_more) { @if (page_check) { <div class="flex pb-6 justify-center align-middle"> <button
      (click)="next()"
      class="flex cursor-pointer items-center justify-center px-3 h-8 text-sm font-medium text-white bg-primary-100 rounded-full">
      {{ 'CREATE_PROD_SPEC._load_more' | translate }}<svg _ngcontent-ng-c1671805716="" width="19" height="19"
        viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path _ngcontent-ng-c1671805716=""
          d="M8.75 10.25V13.5C8.75 13.7125 8.82192 13.8906 8.96575 14.0343C9.10958 14.1781 9.28775 14.25 9.50025 14.25C9.71292 14.25 9.891 14.1781 10.0345 14.0343C10.1782 13.8906 10.25 13.7125 10.25 13.5V10.25H13.5C13.7125 10.25 13.8906 10.1781 14.0343 10.0343C14.1781 9.89042 14.25 9.71225 14.25 9.49975C14.25 9.28708 14.1781 9.109 14.0343 8.9655C13.8906 8.82183 13.7125 8.75 13.5 8.75H10.25V5.5C10.25 5.2875 10.1781 5.10942 10.0343 4.96575C9.89042 4.82192 9.71225 4.75 9.49975 4.75C9.28708 4.75 9.109 4.82192 8.9655 4.96575C8.82183 5.10942 8.75 5.2875 8.75 5.5V8.75H5.5C5.2875 8.75 5.10942 8.82192 4.96575 8.96575C4.82192 9.10958 4.75 9.28775 4.75 9.50025C4.75 9.71292 4.82192 9.891 4.96575 10.0345C5.10942 10.1782 5.2875 10.25 5.5 10.25H8.75ZM9.50175 19C8.18775 19 6.95267 18.7507 5.7965 18.252C4.64033 17.7533 3.63467 17.0766 2.7795 16.2218C1.92433 15.3669 1.24725 14.3617 0.74825 13.206C0.249417 12.0503 0 10.8156 0 9.50175C0 8.18775 0.249333 6.95267 0.748 5.7965C1.24667 4.64033 1.92342 3.63467 2.77825 2.7795C3.63308 1.92433 4.63833 1.24725 5.794 0.74825C6.94967 0.249417 8.18442 0 9.49825 0C10.8123 0 12.0473 0.249333 13.2035 0.748C14.3597 1.24667 15.3653 1.92342 16.2205 2.77825C17.0757 3.63308 17.7528 4.63833 18.2518 5.794C18.7506 6.94967 19 8.18442 19 9.49825C19 10.8123 18.7507 12.0473 18.252 13.2035C17.7533 14.3597 17.0766 15.3653 16.2218 16.2205C15.3669 17.0757 14.3617 17.7528 13.206 18.2518C12.0503 18.7506 10.8156 19 9.50175 19ZM9.5 17.5C11.7333 17.5 13.625 16.725 15.175 15.175C16.725 13.625 17.5 11.7333 17.5 9.5C17.5 7.26667 16.725 5.375 15.175 3.825C13.625 2.275 11.7333 1.5 9.5 1.5C7.26667 1.5 5.375 2.275 3.825 3.825C2.275 5.375 1.5 7.26667 1.5 9.5C1.5 11.7333 2.275 13.625 3.825 15.175C5.375 16.725 7.26667 17.5 9.5 17.5Z"
          fill="white"></path>
      </svg> </button> </div> } } @else { <div role="status" class="w-full h-full flex justify-center align-middle">
    <svg aria-hidden="true" class="w-12 h-12 text-gray-200 animate-spin fill-purple-600" viewBox="0 0 100 101"
      fill="none" xmlns="http://www.w3.org/2000/svg">
      <path
        d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
        fill="currentColor" />
      <path
        d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
        fill="currentFill" />
    </svg> <span class="sr-only">Loading...</span>
  </div> }
</div>
} <!-- ORDER DETAILS modal -->
@if (showOrderDetails){ <div id="order-details-modal" [ngClass]="showOrderDetails ? 'backdrop-blur-sm': ''"
  tabindex="-1" aria-hidden="true"
  class="flex justify-center overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%)] max-h-full ">
  <div class="w-full md:w-3/4 lg:w-1/2 relative bg-white rounded-lg bg-cover bg-right-bottom"
    (click)="$event.stopPropagation();"> <!-- Modal header -->
    <div class="flex items-center justify-between p-2 rounded-t ">
      <h2 class="md:text-3xl lg:text-4xl font-bold text-primary-100 ml-4 m-4">{{ 'PROFILE._order_details' | translate }}
      </h2> <button (click)="showOrderDetails=false;" type="button"
        class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center"
        data-modal-hide="delete-bill-modal"> <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
          fill="none" viewBox="0 0 14 14">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
        </svg> <span class="sr-only">{{ 'CARD._close' | translate }}</span> </button>
    </div> <!-- Modal body -->
    <div class="w-full h-full">
      <div class="p-4 relative overflow-x-auto rounded-lg">
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'PRODUCT_INVENTORY._order_id' | translate }} </p>
          <h3 class="text-base"> {{orderToShow.id}} </h3>
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'PRODUCT_INVENTORY._state' | translate }} </p>
          @if(orderToShow.state == 'inProgress'){ <span
            class="bg-primary-50/30 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded w-fit">{{orderToShow.state}}</span>
          } @else if(orderToShow.state == 'completed') { <span
            class="bg-green text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded w-fit">{{orderToShow.state}}</span>
          } @else if(orderToShow.state == 'failed') { <span
            class="bg-red-500 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{orderToShow.state}}</span>
          } @else if(orderToShow.state == 'pending') { <span
            class="bg-yellow-500 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{orderToShow.state}}</span>
          }@else if(orderToShow.state == 'acknowledged'){ <span
            class="bg-primary-50/30 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{orderToShow.state}}</span>
          }@else if(orderToShow.state == 'cancelled') { <span
            class="bg-red-500 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{orderToShow.state}}</span>
          }
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'PRODUCT_INVENTORY._priority' | translate }} </p>
          <h3 class="text-base"> {{orderToShow.priority}} </h3>
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'PROFILE._billing_address' | translate }} </p>
          <h3 class="text-base"> {{orderToShow.billingAccount.contact[0].contactMedium[1].characteristic.city}},
            {{orderToShow.billingAccount.contact[0].contactMedium[1].characteristic.street1}},
            {{orderToShow.billingAccount.contact[0].contactMedium[1].characteristic.country}}
            ({{orderToShow.billingAccount.name}}) </h3>
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'PROFILE._email' | translate }} </p>
          <h3 class="text-base"> {{orderToShow.billingAccount.contact[0].contactMedium[0].characteristic.emailAddress}}
          </h3>
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'PROFILE._date' | translate }} </p>
          <h3 class="text-base"> {{orderToShow?.orderDate | date:'EEEE, dd/MM/yy, HH:mm'}} </h3>
        </div>
        <table
          class="w-full text-sm text-left rtl:text-right text-primary-100 rounded-lg border border-1 border-secondary-50">
          <thead class="text-primary-100 bg-green">
            <tr>
              <th scope="col" class="px-6 py-3 text-center align-middle"> {{ 'PROFILE._img' | translate }} </th>
              <th scope="col" class="px-6 py-3 text-center align-middle"> {{ 'PROFILE._name' | translate }} </th>
              <th scope="col" class="px-6 py-3 text-center align-middle"> {{ 'PROFILE._price' | translate }} </th>
            </tr>
          </thead>
          <tbody> @for (item of orderToShow.productOrderItem; track item.id; let idx = $index) { <tr class="border-b">
              <td class="px-6 py-4 text-center align-middle flex justify-center items-center"> <img
                  class="w-16 object-contain z-10" src="{{getProductImage(item)}}" alt="Product image"> </td>
              <td class="px-6 py-4 text-center align-middle"> {{item.name}} </td> @if(item.productOfferingPrice){
              @if(item.productOfferingPrice.priceType == 'custom'){ <td class="px-6 py-4 text-center align-middle"> {{
                'PROFILE._custom' | translate }} </td> } @else { <td class="px-6 py-4 text-center align-middle">
                {{item?.productOfferingPrice?.price}} {{item?.productOfferingPrice?.unit}}
                {{item?.productOfferingPrice?.text}} </td> } } @else { <td class="px-6 py-4 text-center align-middle">
                {{ 'SHOPPING_CART._free' | translate }} </td> }
            </tr> } </tbody>
        </table>
        <hr class="h-px my-2 bg-gray-200 border-0">
        <div class="flex block">
          <p class="flex float-left w-1/2 ml-2 text-sm text-gray-500">{{ 'CART_DRAWER._subtotal' | translate }}:</p>
          <hr class="h-px my-2 bg-gray-200 border-0">
          <div class="flex grid grid-cols-1 grid-flow-row w-1/2"> @for (price of
            getTotalPrice(orderToShow.productOrderItem); track price) { <p
              class="flex block justify-end mr-2 text-sm text-gray-500">{{price.price}} {{price.unit}} {{price.text}}
            </p> } @empty { @if(check_custom==true){ <p class="flex flex-right text-gray-700 justify-end text-gray-500">
              {{ 'PROFILE._custom' | translate }}</p> } @else { <p
              class="flex flex-right text-gray-700 justify-end text-gray-500">{{ 'PROFILE._free' | translate }}</p> } }
          </div>
        </div>
      </div>
    </div>
  </div>
</div> }
