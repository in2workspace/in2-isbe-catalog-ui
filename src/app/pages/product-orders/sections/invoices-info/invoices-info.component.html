<div class="border-b border-gray-200 mb-2">
  <ul class="flex flex-wrap -mb-px text-sm font-medium text-center text-gray-500">
    <li class="me-2"> <a (click)="onRoleChange('Customer')"
        [ngClass]="role !== 'Customer' ? 'text-gray-400 group-hover:text-gray-500' : 'text-purple-600 border-purple-600 active'"
        class="inline-flex cursor-pointer items-center justify-center p-4 border-b-2 border-transparent rounded-t-lg group"
        aria-current="page"> <svg
          [ngClass]="role !== 'Customer' ? 'text-gray-400 group-hover:text-gray-500' : 'text-purple-600'"
          class="w-4 h-4 me-2" aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 640 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
          <path
            d="M192 96a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm-8 352l0-96 16 0 0 96-16 0zm-64 0l-88 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l120 0 80 0 376 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-344 0 0-191.1 28.6 47.5c9.1 15.1 28.8 20 43.9 10.9s20-28.8 10.9-43.9l-58.3-97c-17.4-28.9-48.6-46.6-82.3-46.6l-29.7 0c-33.7 0-64.9 17.7-82.3 46.6l-58.3 97c-9.1 15.1-4.2 34.8 10.9 43.9s34.8 4.2 43.9-10.9L120 256.9 120 448zM464 64l0 242.7-25.4-25.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l80 80c12.5 12.5 32.8 12.5 45.3 0l80-80c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L528 306.7 528 64c0-17.7-14.3-32-32-32s-32 14.3-32 32z" />
        </svg> {{ 'INVOICES._as_customer' | translate }} </a> </li> @if(isSeller){ <li class="me-2"> <a
        (click)="onRoleChange('Seller')"
        [ngClass]="{'text-purple-600 border-purple-600 active group': role == 'Seller'}"
        class="inline-flex cursor-pointer items-center justify-center p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 group">
        <svg [ngClass]="role !== 'Seller' ? 'text-gray-400 group-hover:text-gray-500' : 'text-purple-600'"
          class="w-4 h-4 me-2" fill="currentColor" xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 640 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.-->
          <path
            d="M192 96a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm-8 352l0-96 16 0 0 96-16 0zm-64 0l-88 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l120 0 80 0 376 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-344 0 0-191.1 28.6 47.5c9.1 15.1 28.8 20 43.9 10.9s20-28.8 10.9-43.9l-58.3-97c-17.4-28.9-48.6-46.6-82.3-46.6l-29.7 0c-33.7 0-64.9 17.7-82.3 46.6l-58.3 97c-9.1 15.1-4.2 34.8 10.9 43.9s34.8 4.2 43.9-10.9L120 256.9 120 448zM598.6 121.4l-80-80c-12.5-12.5-32.8-12.5-45.3 0l-80 80c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L464 141.3 464 384c0 17.7 14.3 32 32 32s32-14.3 32-32l0-242.7 25.4 25.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3z" />
        </svg> {{ 'INVOICES._as_provider' | translate }} </a> </li> }
  </ul>
</div> @if (loading && !loading_more) { <div role="status"
  class="w-3/4 md:w-4/5 h-full flex justify-center align-middle"> <svg aria-hidden="true"
    class="w-12 h-12 text-gray-200 animate-spin fill-purple-600" viewBox="0 0 100 101" fill="none"
    xmlns="http://www.w3.org/2000/svg">
    <path
      d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
      fill="currentColor" />
    <path
      d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
      fill="currentFill" />
  </svg> <span class="sr-only">Loading...</span> </div>
} @else { <div class="">
  <!-- <h2 class="md:text-3xl lg:text-4xl font-bold text-primary-100 ml-4 m-4">{{ 'PROFILE._order_list' | translate }}</h2> <hr class="h-px mr-4 ml-4 bg-primary-100 border-0">-->
  <div class="m-4 relative overflow-x-auto border border-primary-100 sm:rounded-lg">
    <table class="w-full text-sm text-left rtl:text-right text-primary-100">
      <thead class="text-xs text-gray-700 uppercase bg-white">
        <tr>
          <th scope="col" class="px-6 py-3 text-center align-middle"> {{ 'INVOICES._date' | translate }} </th>
          <th scope="col" class="hidden md:table-cell px-6 py-3 text-center align-middle"> {{ 'INVOICES._name' |
            translate }} </th>
          <th scope="col" class="hidden md:table-cell px-6 py-3 text-center align-middle"> {{ 'INVOICES._type' |
            translate }} </th>
          <th scope="col" class="hidden md:table-cell px-6 py-3 text-center align-middle"> {{
            'INVOICES._tax_included_amount' | translate }} </th>
          <th scope="col" class="hidden md:table-cell px-6 py-3 text-center align-middle"> {{ 'INVOICES._status' |
            translate }} </th>
          <th scope="col" class="text-center align-middle"> {{ 'INVOICES._actions' | translate }} </th>
        </tr>
      </thead>
      <tbody> @for (invoice of invoices; track invoice.id; let idx = $index) { <tr
          class="border-b bg-gray-100 hover:bg-gray-200">
          <td class="px-6 py-4 text-center align-middle"> {{invoice?.date | date:'EEEE, dd/MM/yy, HH:mm'}} </td>
          <td class="md:table-cell px-6 py-4 text-center align-middle"> @if(role=='Seller'){ @if (editingIndex === idx)
            { <input [(ngModel)]="editableInvoiceName" type="text" id="invoicename"
              class="mb-2 border-gray-300 bg-gray-50 border text-gray-900 text-sm rounded-lg focus:ring-black focus:border-black block w-full p-2.5" />
            } @else { {{invoice?.name}} } }@else{ {{invoice?.name}} } </td>
          <td class="md:table-cell px-6 py-4 text-center align-middle"> {{invoice?.type}} </td>
          <td class="md:table-cell px-6 py-4 text-center align-middle">
            {{invoice?.taxIncludedAmount.value}}{{invoice?.taxIncludedAmount.unit}} </td>
          <td class="md:table-cell px-6 py-4 text-center align-middle"> @if(invoice?.isBilled){ <span
              class="bg-green text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{
              'INVOICES._billed' | translate }}</span> } @else { <span
              class="bg-yellow-500 text-primary-100 text-xs font-medium me-2 px-2.5 py-0.5 rounded">{{
              'INVOICES._pending' | translate }}</span> } </td>
          <td class="px-6 py-4 text-center align-middle flex flex-row"> <button
              (click)="toggleShowDetails(invoice);$event.stopPropagation();" type="button"
              class="text-white bg-primary-100 hover:bg-purple-800 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-full text-sm p-2.5 text-center inline-flex items-center me-2">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M5 19H6.2615L16.498 8.7635L15.2365 7.502L5 17.7385V19ZM4.404 20.5C4.14783 20.5 3.93317 20.4133 3.76 20.24C3.58667 20.0668 3.5 19.8522 3.5 19.596V17.8635C3.5 17.6197 3.54683 17.3873 3.6405 17.1663C3.734 16.9453 3.86283 16.7527 4.027 16.5885L16.6905 3.93075C16.8417 3.79342 17.0086 3.68733 17.1913 3.6125C17.3741 3.5375 17.5658 3.5 17.7663 3.5C17.9668 3.5 18.1609 3.53558 18.3488 3.60675C18.5368 3.67792 18.7032 3.79108 18.848 3.94625L20.0693 5.18275C20.2244 5.32758 20.335 5.49425 20.401 5.68275C20.467 5.87125 20.5 6.05975 20.5 6.24825C20.5 6.44942 20.4657 6.64133 20.397 6.824C20.3283 7.00683 20.2191 7.17383 20.0693 7.325L7.4115 19.973C7.24733 20.1372 7.05475 20.266 6.83375 20.3595C6.61275 20.4532 6.38033 20.5 6.1365 20.5H4.404ZM15.8562 8.14375L15.2365 7.502L16.498 8.7635L15.8562 8.14375Z"
                  fill="#666666" fill-opacity="0.6" />
              </svg>
            </button> @if(role=='Seller'){ @if (editingIndex === idx) { <!-- Save button --> <button
              (click)="saveInvoice(idx, invoice);" type="button"
              class="text-white bg-green-500 hover:bg-green-700 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-full text-sm p-2.5 text-center inline-flex items-center me-2">
              <fa-icon [icon]="faSave" class="text-[18px] text-white align-middle"></fa-icon> </button> } @else {
            <!-- Edit button --> <button (click)="editInvoice(idx, invoice);" type="button"
              class="text-white bg-primary-100 hover:bg-purple-800 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-full text-sm p-2.5 text-center inline-flex items-center me-2">
              <fa-icon [icon]="faEdit" class="text-[18px] text-white align-middle"></fa-icon> </button> } }
          </td>
        </tr> } </tbody>
    </table> @if(invoices.length == 0){ <div class="text-center items-center w-full col-span-2"> <span
        class="text-gray-900 text-sm text-center w-full font-medium">{{ 'PROFILE._no_orders' | translate }}</span>
    </div> }
  </div> @if (!loading_more) { @if (page_check) { <div class="flex pb-6 justify-center align-middle"> <button
      (click)="next()"
      class="flex cursor-pointer items-center justify-center px-3 h-8 text-sm font-medium text-white bg-primary-100 rounded-full">
      {{ 'CREATE_PROD_SPEC._load_more' | translate }}<svg _ngcontent-ng-c1671805716="" width="19" height="19"
        viewBox="0 0 19 19" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path _ngcontent-ng-c1671805716=""
          d="M8.75 10.25V13.5C8.75 13.7125 8.82192 13.8906 8.96575 14.0343C9.10958 14.1781 9.28775 14.25 9.50025 14.25C9.71292 14.25 9.891 14.1781 10.0345 14.0343C10.1782 13.8906 10.25 13.7125 10.25 13.5V10.25H13.5C13.7125 10.25 13.8906 10.1781 14.0343 10.0343C14.1781 9.89042 14.25 9.71225 14.25 9.49975C14.25 9.28708 14.1781 9.109 14.0343 8.9655C13.8906 8.82183 13.7125 8.75 13.5 8.75H10.25V5.5C10.25 5.2875 10.1781 5.10942 10.0343 4.96575C9.89042 4.82192 9.71225 4.75 9.49975 4.75C9.28708 4.75 9.109 4.82192 8.9655 4.96575C8.82183 5.10942 8.75 5.2875 8.75 5.5V8.75H5.5C5.2875 8.75 5.10942 8.82192 4.96575 8.96575C4.82192 9.10958 4.75 9.28775 4.75 9.50025C4.75 9.71292 4.82192 9.891 4.96575 10.0345C5.10942 10.1782 5.2875 10.25 5.5 10.25H8.75ZM9.50175 19C8.18775 19 6.95267 18.7507 5.7965 18.252C4.64033 17.7533 3.63467 17.0766 2.7795 16.2218C1.92433 15.3669 1.24725 14.3617 0.74825 13.206C0.249417 12.0503 0 10.8156 0 9.50175C0 8.18775 0.249333 6.95267 0.748 5.7965C1.24667 4.64033 1.92342 3.63467 2.77825 2.7795C3.63308 1.92433 4.63833 1.24725 5.794 0.74825C6.94967 0.249417 8.18442 0 9.49825 0C10.8123 0 12.0473 0.249333 13.2035 0.748C14.3597 1.24667 15.3653 1.92342 16.2205 2.77825C17.0757 3.63308 17.7528 4.63833 18.2518 5.794C18.7506 6.94967 19 8.18442 19 9.49825C19 10.8123 18.7507 12.0473 18.252 13.2035C17.7533 14.3597 17.0766 15.3653 16.2218 16.2205C15.3669 17.0757 14.3617 17.7528 13.206 18.2518C12.0503 18.7506 10.8156 19 9.50175 19ZM9.5 17.5C11.7333 17.5 13.625 16.725 15.175 15.175C16.725 13.625 17.5 11.7333 17.5 9.5C17.5 7.26667 16.725 5.375 15.175 3.825C13.625 2.275 11.7333 1.5 9.5 1.5C7.26667 1.5 5.375 2.275 3.825 3.825C2.275 5.375 1.5 7.26667 1.5 9.5C1.5 11.7333 2.275 13.625 3.825 15.175C5.375 16.725 7.26667 17.5 9.5 17.5Z"
          fill="white"></path>
      </svg>
    </button> </div> } } @else { <div role="status" class="w-full h-full flex justify-center align-middle">
    <svg aria-hidden="true" class="w-12 h-12 text-gray-200 animate-spin fill-purple-600" viewBox="0 0 100 101"
      fill="none" xmlns="http://www.w3.org/2000/svg">
      <path
        d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"
        fill="currentColor" />
      <path
        d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"
        fill="currentFill" />
    </svg> <span class="sr-only">Loading...</span>
  </div> }
</div>
} <!-- INVOICE DETAILS modal-->
@if (showInvoiceDetails){ <div id="invoice-details-modal" [ngClass]="showInvoiceDetails ? 'backdrop-blur-sm': ''"
  tabindex="-1" aria-hidden="true"
  class="flex justify-center overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%)] max-h-full ">
  <div class="w-full md:w-3/4 lg:w-1/2 relative bg-white rounded-lg bg-cover bg-right-bottom"
    (click)="$event.stopPropagation();"> <!-- Modal header -->
    <div class="flex items-center justify-between p-2 rounded-t ">
      <h2 class="md:text-3xl lg:text-4xl font-bold text-primary-100 ml-4 m-4">{{ 'INVOICES._invoice_details' | translate
        }}</h2> <button (click)="showInvoiceDetails=false;" type="button"
        class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center"
        data-modal-hide="delete-bill-modal"> <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"
          fill="none" viewBox="0 0 14 14">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6" />
        </svg> <span class="sr-only">{{ 'CARD._close' | translate }}</span> </button>
    </div> <!-- Modal body -->
    <div class="w-full h-full">
      <div class="p-4 relative overflow-x-auto rounded-lg">
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'INVOICES._invoice_id' | translate }} </p>
          <h3 class="text-base"> {{invoiceToShow.id}} </h3>
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'INVOICES._date' | translate }} </p> {{invoiceToShow?.date |
          date:'EEEE, dd/MM/yy, HH:mm'}}
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'INVOICES._name' | translate }} </p>
          <h3 class="text-base"> {{invoiceToShow.name}} </h3>
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'INVOICES._description' | translate }} </p>
          <h3 class="text-base"> {{invoiceToShow.type}} </h3>
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'INVOICES._tax_excluded_amount' | translate }} </p>
          <h3 class="text-base"> {{invoiceToShow?.taxExcludedAmount.value}}{{invoiceToShow?.taxExcludedAmount.unit}}
          </h3>
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'INVOICES._tax_included_amount' | translate }} </p>
          <h3 class="text-base"> {{invoiceToShow?.taxIncludedAmount.value}}{{invoiceToShow?.taxIncludedAmount.unit}}
          </h3>
        </div>
        <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'INVOICES._tax' | translate }} </p>
          <h3 class="text-base">
            {{invoiceToShow?.appliedTax[0].taxAmount.value}}{{invoiceToShow?.appliedTax[0].taxAmount.unit}} </h3>
        </div> @if (invoiceToShow?.isBilled){ <div class="flex flex-row gap-2 pb-2 text-gray-600">
          <p class="w-fit text-base font-bold shrink-0"> {{ 'INVOICES._product' | translate }} </p>
          <h3 class="text-base"> <a class="font-medium mr-1 text-purple-600 hover:underline"
              (click)="goToProduct(invoiceToShow?.product.id)">{{invoiceToShow?.product.id}}</a> </h3>
        </div> }
      </div>
    </div>
  </div>
</div>
}
